(function(){var b=true,a=1,p=0,B="\\$\\{[^}]*\\}",o="[=a-z][a-z0-9]*",H="\\{\\{(?:"+o+"[\\s\\S]*?|/"+o+"\\s*)\\}\\}",q=new RegExp("(?="+B+"|"+H+")","gi"),I=new RegExp("^\\{\\{(/?)(=|[a-z][a-z0-9]*)([\\s\\S]*)\\}\\}","i"),n="[a-z_$]\\w*",t=new RegExp("^\\s*(?:\\(\\s*("+n+")\\s*(?:,\\s*("+n+")\\s*)?\\)\\s*)?(\\S(?:[\\s\\S]*\\S)?)\\s*$","i"),e=new RegExp("^\\s*(?:\\(([\\s\\S]*)\\)\\s*)?([^\\s()](?:[^()]*[^\\s()])?)\\s*$"),s="$index",r="$value",d="templatePlugins",c="templates",v="template",y="tmpl",h={each:a,"if":a,wrap:a};function u(c){var b={};$.each(c.split(q),function(e,d){var c;if(c=d.match(/^\{\{\/([a-z][a-z0-9]*)[\s\S]*\}\}/i))b[c[1]]=a});return b}function E(g,i){var h=["",""],d=[h],c=h,f=0;$.each(g.replace(/\{#[\s\S]*?#\}/g,"").replace(/\{\{!?|\}\}|(?:[^{}]|\{(?!\{)|\}(?!\}))+/g,function(a){if(a==="{{!"){++f;return""}else if(f){if(a==="}}")--f;else if(a==="{{")++f;return""}else return a}).split(q),function(q,h){var f=h.match(I);if(f){if(f[1]){if(b&&c[0]!==f[2])throw new Error("Misplaced "+h+" in "+g);c=d[--d.length-1]}else{var l=[f[2],f[3]];if(b)if(f[2]==="=")try{Function("("+f[3]+")")}catch(n){throw new Error("Invalid template substitution: "+f[3]);}else if(f[2]==="tmpl"){var j=f[3].match(e);try{Function("(["+j[1]+"])");Function("("+j[2]+")")}catch(o){throw new Error("Invalid {{"+f[2]+"}} content: "+f[3]);}}c.push(l);i[f[2]]===a&&d.push(c=l)}h=h.substring(f[0].length)}else if(h.substring(0,2)==="${"){var m=h.indexOf("}");c.push(["=",h.substring(2,m)]);if(b){var k=c[c.length-1][1];try{Function("("+k+")")}catch(p){throw new Error("Invalid template substitution: "+k);}}h=h.substring(m+1)}h&&c.push(h)});if(b&&d.length>1)throw new Error("Unclosed block directives "+d.slice(1).map(function(a){return a[0]})+" in "+g);return h}function g(d,c){var b=[];(function e(h,d){if("string"!==typeof d){var f=d[0],g=d.length;if(f==="="&&!/\}/.test(d[1]))b.push("${",d[1],"}");else{f&&b.push("{{",f,d[1],"}}");$.each(d.slice(2),e);f&&(g!==2||!c||c[f]===a)&&b.push("{{/",f,"}}")}}else b.push(d.replace(/\{([\{#])/,"{{##}$1"))})(2,d);return b.join("")}var f="extAll";$[f]=function(d){for(var e=arguments,c,b,a=1;a<e.length;++a)for(b in c=e[a])d[b]=c[b];return d};function x(m){var k="$$tmplVar",i=0,c=["var "+k+"0;$item=$item||{};with($data=$."+f+"(Object.create?Object.create(null):{},$data||{})){return("],j=[],d;$.each(m.slice(2),function l(I,m){d&&c.push("+");var o;if("string"===typeof m)c.push(C(m));else{var y=m[0],u=m[1],B=m.length,n=k+i;if(y==="="){!d&&c.push("''+");var E="",F="";u=u.replace(/(=>[\w.$\[\]]+)+$/,function(a){a=a.split("=>");F=(new Array(a.length)).join(")");E=a.reverse().join("(");return""});c.push("(",n,"=(",u,"),",E,"'function'!==typeof ",n,"?",n,":",n,".call(null,arguments))",F)}else if(y==="if"){for(var q=2,v,w,x=d=a;x;q=v+1){v=B;for(w=q;w<v;++w)if(m[w][0]==="else")v=w;var G=q<B?(q===2?m:m[q-1])[1]:"";x=/\S/.test(G);if(b&&!x)if(q===2)throw new Error("{{if}} missing condition:"+g(m,{}));else if(v!==B)throw new Error("{{else}} without condition must be last:"+g(m,{}));c.push(d?"":"''",q===2?"((":"):(",G,x?")?(":"");d=p;$.each(m.slice(q,v),l)}c.push(d?"))":"''))")}else if(y==="each"){o=u.match(t);if(b&&!o)throw new Error("Malformed {{each}} content: "+u);var A=o[1]||s,z=o[2]||r,H=o[3];++i;c.push("(",n,"=[],$.each((",H,"),function(",A,",",z,"){var ",k,i,";",n,".push(");d=p;j.push(A+":"+A,z+":"+z);$.each(m.slice(2),l);j.length-=2;!d&&c.push("''");c.push(")}),",n,".join(''))");--i}else if(y==="tmpl"){o=u.match(e);if(b&&!o)throw new Error("Malformed {{tmpl}} content: "+u);var D=o[1];c.push("(",n,"=",D?"$.extend([],arguments,["+D+"])":j.length?"[$."+f+"({},$data,{"+j+"}),$item]":"arguments",",$.template((",o[2],")).tmpl(",n,"[0],",n,"[1]))")}else if(b)throw new Error("I do not know how to compile "+g(m,h));}d=a});c.push(d?")}":"'')}");if(b)try{return Function("$data","$item",c.join(""))}catch(n){throw new Error(c.join(""));}else return Function("$data","$item",c.join(""))}var i=false;$[d]=[];function m(b){var a=$[c][b];return a&&"function"!==typeof a[y]}function l(f,i){var b={};$.each(f,function j(d,g){if(b[d]!==a){b[d]=a;$.each(g,function(i,g){if(g[0]==="tmpl"||g[0]==="wrap"){var h=g[1].match(e);if(h){var d=Function("return "+h[2])();m(d)&&b[d]!==a&&j(d,f[d]=$[c][d])}}})}});function g(a){return function(c){for(var b=0;b<a;++b)c=$[d][b](c,g(b));return c}}var h;$.each(g($[d].length)(f),function(a,d){var b={tmpl:x(d)};if(a!==i)$[c][a]=b;else h=b});return h}$[c]={};$[v]=function J(a,e){if(i)return $[c][a];var d=$[c],b;if(arguments.length===1){if(a.indexOf("<")+1)return J(null,a);if(m(a)){b={};b[a]=d[a];l(b)}return d[a]}var f=E(e,$.extend(u(e),h));if(a===null)return l(b={_:f},"_");d[a]=f};var j={"&":"&amp;","<":"&lt;",">":"&gt;"};function A(a){return j[a]||(j[a]="&#"+a.charCodeAt(0)+";")}var k={"\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","/":"\\/","\\":"\\\\"};function F(b){var a;return k[b]||(a=b.charCodeAt(0).toString(16),k[b]="\\u0000".substring(0,6-a.length)+a)}var z=/[\x00"&'<>]/g,D=/[\x00\x08-\x0d"&'\/<->\\\x85\u2028\u2029]/g;function G(a){return a===undefined?"":String(a).replace(z,A)}function C(a){return"'"+String(a).replace(D,F)+"'"}var w="encode";$[w]=G;!i&&$[d].push(function(a){$.each(a,function b(c,a){if("string"!==typeof a)if(a[0]==="=")a[1]+="=>$.encode";else if(a[0]==="html")a[0]="=";else $.each(a,b)});return a})})()